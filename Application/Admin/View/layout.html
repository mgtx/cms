<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head>	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />	<meta http-equiv="X-UA-Compatible" content="IE=edge">	<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0" /><!--判断手机端代码-->	<title>后台管理系统</title>	<meta name="keywords" content="" />	<meta name="description" content="" />	<!--相应式框架css-->	<import type="css" file="Css.style" />	<import file="Js.jquery-1#11#1#min,Js.jquery-1#9#0#min,Js.jquery-3#1#1#min" />	<import file="Js.MyJs" /></head><body ><div  class="animsition" data-animsition-in="fade-in-left-sm"><!-- ==左侧导航== -->	<div class="left_nav" id="leftH">		<include file="Public:left" />	</div>	<!-- ==右侧内容栏== -->	<div class="right_content" id="rightC">			{__CONTENT__}	</div>	<include file="Public:footer"/></div><script type="text/javascript">	// 同步部门和员工信息到数据库	function UpDateMessage(){		//传值		var Url     =  "{:U('Index/Synchronization')}";		$.ajax({			url:Url,  //显示数据的处理页面			data:{}, //页数和查询都要传值			type:"POST",			dataType:"JSON", //这里我们用JSON的数据格式			success: function(data){				//console.log(data);				alert(data.msg);				location.reload(true);			}		});	}	//设置个人目标额	function changeTarget(num){		var userid   = document.getElementById('userid_'+num).value;		var name   = document.getElementById('name_'+num).value;		var target = document.getElementById('target_'+num).value;		//alert(target);		//传值		var Url     =   "{:U('Target/personageAjax')}";		var item    = {'userid':userid,'name':name,'target':target}		$.ajax({			url:Url,  //显示数据的处理页面			data:item, //页数和查询都要传值			type:"POST",			dataType:"JSON", //这里我们用JSON的数据格式			success: function(data) {				//console.log(data)				alert(data.msg);				location.reload(true);			}		});	}	function all_change(){		//var name_str = document.getElementById("name_str").value		var target_str = document.getElementById("target_str").value		if(target_str == ""){			alert("没有需要设置或改变的金额");			return false;		}		return true;	}	//批量操作个人目标额	function  target_change(num){		var new_userid = "";		var new_name = "";		var new_target = "";		var userid_id = "userid_"+num;		var name_id = "name_"+num;		var target_id = "target_"+num;		var userid_str = document.getElementById('userid_str').value;		var name_str = document.getElementById('name_str').value;		var target_str =document.getElementById('target_str').value;		var userid = document.getElementById(userid_id).value;		var name = document.getElementById(name_id).value;		var target =document.getElementById(target_id).value;		if(name_str==''){			new_userid = userid;			new_name = name;			new_target = target;		}else{			var new_str = split_str(userid_str,name_str,target_str,userid,name,target);			new_userid 	= new_str.userid_str;			new_name 	= new_str.name_str;			new_target	=new_str.target_str;		}		/*alert(new_name);		alert(new_target);*/		document.getElementById('userid_str').value = new_userid;		document.getElementById('name_str').value = new_name;		document.getElementById('target_str').value = new_target;		return;	}	function split_str(userid_str,name_str,target_str,userid,name,target){		var userIds = new Array();		var names = new Array();		var targets = new Array();		userIds	=	userid_str.split(","); //字符分割		names	=	name_str.split(","); //字符分割		targets	=	target_str.split(","); //字符分割		var new_userId_str = '';		var new_name_str = '';		var new_target_str = '';		if(name_str.indexOf(name) == -1){			new_userId_str = userid_str+','+userid;			new_name_str = name_str+','+name;			new_target_str = target_str+','+target;		}else{			new_name_str = name_str;			for(var i= 0 ; i < names.length ; i++){				if(names[i]==name){					userIds[i] = userid;					targets[i] = target;				}			}			new_userId_str = userIds.join(',')			new_target_str = targets.join(',')		}		return {userid_str:new_userId_str,name_str:new_name_str,target_str:new_target_str};	}	//获取产品的销售排序	function changeProducts(type){		var product = document.getElementById('product').value;		var Url     =   "{:U('Statistical/get_product')}";		var item    = {'product':product,'type':type}		$.ajax({			url:Url,  //显示数据的处理页面			data:item, //页数和查询都要传值			type:"POST",			dataType:"JSON", //这里我们用JSON的数据格式			success: function(data) {				console.log(data)				if(data.code==-1){					alert(data.msg);					location.reload(true);				}else{					var list_personage,Syn_personage,list_department,Syn_department;					list_personage	=new StringBuffer();					list_department	=new StringBuffer();					Syn_personage 	= data.list.personage;					Syn_department = data.list.department;					/*个人产品总业绩*/					$.each((Syn_personage),function(i,result){						list_personage.append("<tr>");						list_personage.append("<td>"+(i+1)+"</td>");						list_personage.append("<td>"+result.name+"</td>");						list_personage.append("<td>"+result.sum+"</td>");						list_personage.append("</tr>");					});					var head_personage="<tr><th colspan='3'>"+type+"个人产品总销售额排名</th></tr><tr><td>排名</td><td>姓名</td><td>总销售额(元)</td></tr>";					/*按部产品总业绩*/					$.each((Syn_department),function(m,item){						list_department.append("<tr>");						list_department.append("<td>"+(m+1)+"</td>");						list_department.append("<td>"+item.dep_name+"</td>");						list_department.append("<td>"+item.sum+"</td>");						list_department.append("</tr>");					});					var head_department="<tr><th colspan='3'>"+type+"部门产品总销售额排名</th></tr><tr><td>排名</td><td>部门名称</td><td>总销售额(元)</td></tr>";					$("#Syn_personage").html(head_personage+list_personage.toString());					$("#Syn_department").html(head_department+list_department.toString());				}			}		});	}	// 高效的字符串拼接函数，替代使用+号的低效率拼接，使用时直接复制即可	function StringBuffer() {		this.__strings__ = new Array();	}	StringBuffer.prototype.append = function (str) {		this.__strings__.push(str);		return this;    //方便链式操作	}	StringBuffer.prototype.toString = function () {		return this.__strings__.join("");	}</script></body></html>